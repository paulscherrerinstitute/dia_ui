<link rel="import"  href="bower_components/polymer/polymer-element.html">
<link rel="import"  href="bower_components/polymer/lib/elements/dom-repeat.html">
<link rel="import"  href="dia-status.html">

<dom-module id="dia-control-panel">

    <template>

        <dia-status status="{{data.status}}"></dia-status>

        <h1>Status details</h1>

        <template is="dom-repeat" items="{{_toArray(data.details)}}">
            <p><b>[[item.name]]</b>: [[item.value]]</p>
        </template>

        <h1>Clients enabled</h1>

        <template is="dom-repeat" items="{{_toArray(data.clients_enabled)}}">
            <p><b>[[item.name]]</b>: [[item.value]]</p>
        </template>

    </template>

    <script>
        HTMLImports.whenReady(function() {
            Polymer({
                is: 'dia-control-panel',

                _updateData: function() {

                    this.async(function() {
                        this.$.ajax.generateRequest();
                    }, 1000);

                },

                _onResponse: function() {
                    this._updateData();
                },

                _toArray: function(obj) {
                    return Object.keys(obj).map(function(key) {
                        return {
                            name: key,
                            value: obj[key]
                        };
                    });
                }
            });
        });
    </script>


</dom-module>